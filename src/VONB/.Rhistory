source('~/Documents/UBC_Courses/Fish_504/Tutorials2011/BrownieSim.R')
Brownie Model Simulator.
Random number seed
set.seed(8879)
I <- 3 #Number of years of marking
J <- 4 #Number of years of recaps
m <- 0.5 #true natural mortality
ni <- rpois(I,550)
fj <- rbeta(J,4,12)
P = recapture probability
Z = total mortality
F = fishing mortality
R = recaptures
P=Z=F=R=matrix(nrow=I,ncol=J)
R[i,i:J]=rmultinom(1,ni[i],p)
print(cbind(ni,R))
End of data generation.
PARAMETER_SECTION
theta = list(log.m=log(0.5),log.fj=log(fj))# rep(0.1,length=J))
itheta = as.relistable(theta)
PROCEDURE_SECTION
brownie <- function(theta)
with(relist(theta,skeleton=itheta),{
m=exp(log.m)
fj=exp(log.fj)
compute predicted recaptures given ni
P=Z=F=Rhat=matrix(nrow=I,ncol=J)
cj = fj/(m+fj)*(1-exp(-m-fj))
nll = 0
for(i in 1:I)
tmp_m=(seq(1,length(i:J),1)-1)*m
tmp_f=c(0,cumsum(fj[i:(J-1)]))
Z[i,i:J]=tmp_m + tmp_f
p=exp(-Z[i,i:J])*cj[i:J]
Rhat[i,i:J]=ni[i]*p#rmultinom(1,ni[i],p)
nll=nll   +sum(-dpois(R[i,i:J],Rhat[i,i:J],log=TRUE))
nll=nll+sum(-dmultinom(R[i,i:J],prob=p,log=TRUE))
return(nll)
})
Solver routine to estimate parameters.
solver<-function(theta,objfun,hess=FALSE)
fit<-optim(theta,objfun,method="BFGS",hessian=hess)
if(hess==TRUE)
{
H=fit$hessian     #Matrix of 2nd derivatives
V=solve(H)        #Variance covariance matrix
std=sqrt(diag(V))  #Std of parameters
R=V/(std %o% std) #Correlations.
fit$R=R; fit$std=std
return(fit)
}
fit <- solver(unlist(itheta),brownie,TRUE)
print(exp(fit$par))
source('~/Documents/UBC_Courses/Fish_504/ASSIGNMENTS/FISHGROWTH/GrowthSim.R')
source('~/Documents/UBC_Courses/Fish_504/ASSIGNMENTS/FISHGROWTH/vonB.R')
fit$par
iF<-read.table(pipe("pbpaste"))
matplot(iF)
F<-read.table(pipe("pbpaste"))
matlines(F)
0.2
sqrt(0.2)
sqrt(1-0.2)
1-sqrt(0.2)
plot(bt)
bt=scan()
mean(bt)
mean(bt[-1])
abline(v=1)
xx <- read.table(pipe("pbpaste"))
matplot(xx[,2:4],xx[,5:7],type="l")
matplot(xx[,5:7],type="l")
ax
px
pwd
dir()
x=scan()
X=read.table(pipe("pbpaste"))
X
x
cbind(1978:2012,X)
cbind(1978:2012,1,X)
ps = read.table(pipe("pbpaste"))
ps
yr=1978:2012
yr
ii
yr[ii]
cbind(yr[ii],2,ps)
cbind(yr[ii],2,ps,0,0)
cbind(yr[ii],2,ps,V7=0,V8=0)
ct = read.table(pipe("pbpaste"))
ct
ii=scan()
cbind(yr[ii],ct)
o = read.table(pipe("pbpaste"))
o
cbind(yr[ii],gr=3,o)
cbind(yr[ii],gr=3,o,V4=0,V5=0,V6=0,V7=0,V8=0)
q()
vonBH.R#
require(Riscam)#
require(ggplot2)#
A <- read.admb("vonBH")#
A$rp <- read.table("vonBH.mcmc", header=TRUE)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF <- data.frame(area=sa[A$area],sex=sx[A$sex], age=A$age, fl=A$fl, fl_hat=A$fl_hat, epsilon=A$epsilon)#
#
quartz("Size at age", width=10, height=6)#
#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(age, epsilon, col=sex)) +geom_point(size=1)+geom_smooth()#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
#
p1 #
p2 #
p3#
#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p4#
#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
p5#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p7#
#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.15)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p#
p8
M <- seq(0,2,length=100)
M <- seq(0,0.3,length=100)
mu = 0.15
sd = 0.03
?gamma
?dgamma
s = sd^2/mu
a = mu/s
plot(M,dgamma(M,a,s))
plot(M,dgamma(M,a,1/s))
a
s
1/s
dgamma(0.25,a,1/s)
dgamma(0.25,a,1/s,log=TRUE)
p  <- ggplot(DF, aes(age, epsilon, col=sex)) +geom_point(size=1)#+geom_smooth()#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p
p  <- ggplot(DF, aes(age, epsilon, col=sex)) +geom_point(size=1)+geom_boxplot()#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p
p  <- ggplot(DF, aes(age, epsilon, col=sex))+geom_boxplot()#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p
?geom_boxplot
p  <- ggplot(DF, aes(age, epsilon, col=sex))+geom_boxplot(aes(fill=age))#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot()#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p
p3
vonBH.R#
#
# DATA SECTION#
require(Riscam)#
require(ggplot2)#
A <- read.admb("vonBH")#
A$rp <- read.table("vonBH.mcmc", header=TRUE)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF <- data.frame(area=sa[A$area],sex=sx[A$sex], age=A$age, fl=A$fl, fl_hat=A$fl_hat, epsilon=A$epsilon)#
#
# GRAPHICAL SECTION#
# Index:#
# 		p1 <- length-at-age plots for male and female by area#
# 		p2 <- length-age by sex overlayed areas#
#       p3 <- residual distribution as box plots by sex#
quartz("Size at age", width=10, height=6)#
#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p4#
#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
p5#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p7#
#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.15)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p#
p8
p5
names(A)
ggplot(A$post.sampe[,1])+geom_line()
ggplot(A$post.sampe[,1])
p<-ggplot(A$post.samp[,1])
p<-ggplot(as.data.frame(A$post.samp[,1]))
p<-ggplot(as.data.frame(A$post.samp[,1]))+geom_points()
p<-ggplot(as.data.frame(A$post.samp[,1]))+geom_point()
p<-ggplot(as.data.frame(A$post.samp))+geom_point(aes(y=post.samp[,1]))
plot(A$post.samp[,1])
plot(A$post.samp[,1],type="l")
hist(A$post.samp[,1])
lines(M,dgamma(M,a,1/s))
M
lines(dgamma(M,a,1/s))
hist(A$post.samp[,1],prob=TRUE)
lines(dgamma(M,a,1/s),col=2)
h<-hist(A$post.samp[,1],prob=TRUE)
h
vonBH.R#
#
# DATA SECTION#
require(Riscam)#
require(ggplot2)#
A <- read.admb("vonBH")#
A$rp <- read.table("vonBH.mcmc", header=TRUE)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF <- data.frame(area=sa[A$area],sex=sx[A$sex], age=A$age, fl=A$fl, fl_hat=A$fl_hat, epsilon=A$epsilon)#
#
# GRAPHICAL SECTION#
# Index:#
# 		p1 <- length-at-age plots for male and female by area#
# 		p2 <- length-age by sex overlayed areas#
#       p3 <- residual distribution as box plots by sex#
#       p4 <- qqplot on residuals by area and sex#
# 		p5 <- qqplot on age residuals #
#		p6 <- weight-at-age fits by area and sex#
#       p7 <- Marginal posteriors for F0.1 for male and female by area panels#
#       p8 <- Marginal posterior plots for F0.1 for female by area.#
#
quartz("Size at age", width=10, height=6)#
#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.15)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p
pairs(A$post.samp[,1:9])
pairs(A$post.samp[,1:11],pch=".")
pairs(A$post.samp[,1:11],pch=".",gap=0)
?version
R.Version()
R-script for the state-space production model with random effects.#
# Author: Steven Martell#
# Date: May 21,  2012#
# Location: Hobart,  Tasmania#
# Libraries#
source("read.admb.R")#
A <- read.admb("pm")#
class(A) <- "admb"#
class(A$post.samp) <- "psv"#
A$mc <- read.table("pm.mcmc", header=TRUE)#
class(A$mc) <- "mc"#
A$ctrl<- read.table("pm.ctl", header=FALSE)#
#
print.admb<- function(A)#
{#
	print(A$fit$npar)#
}#
#
plot.admb <- function(A, add=FALSE, ...)#
{#
	with(A, {#
		yr = iyr#
		par(mfcol=c(2, 2), mar=c(5, 4, 1, 1))#
		plot(yr, bt, type="l", xlab="Year", ylab="Biomass", ylim=c(0, max(bt)))#
		plot(yr, pt, type="l", xlab="Year", ylab="Depletion", ylim=c(0, 1))#
		plot(yr, it_hat, type="l", xlab="Year", ylab="CPUE")#
		points(yr, it, pch=20)#
		plot(yr, epsilon, type="h", xlab="Year", ylab="Residual")			#
	})#
}#
#
plot.psv <- function(ps)#
{#
	# ps is a matrix of posterior sample values#
	require(hacks)#
	quantiles <- apply(ps,2,quantile, probs=c(0.025, 0.5, 0.975))#
	lbl=A$fit$names#
	ii <<- 0#
	plot.trace <- function(x)#
	{#
		ii <<- ii +1#
		qi = quantile(x, probs=c(0.025,0.25,  0.5, 0.75, 0.975))#
		plot(x, type="l", xlab="Iteration", ylab="Posterior sample", main=lbl[ii])#
		xx = c(1, length(x), length(x), 1)#
		yy = c(qi[1], qi[1], qi[5], qi[5])#
		polygon(xx, yy, col=colr("grey", 0.2), border=NA)#
		yy = c(qi[2], qi[2], qi[4], qi[4])#
		polygon(xx, yy, col=colr("grey", 0.3), border=NA)#
		abline(h=qi[3], col=colr(2, 0.5), lwd=3)#
	}#
	apply(ps, 2, plot.trace)#
}#
plot.mc <- function(mc)#
{#
	require(MCMCpack)	# needed for dinvgamma#
	par(mfrow=c(3, 3), mar=c(5, 4, 1, 1))#
	pr.fn <- #
	plot.den <- function(i)#
	{#
		lbl <- names(mc)#
		ps  <- mc[[i]]#
		if(sd(ps)!=0)#
		{#
			psd = density(ps, adjust=1.5)#
			xl  = range(ps)*c(0.0, 1.5)#
			plot(psd, ylab="posterior density", xlab=lbl[i], main="", xlim=xl, lwd=2)#
			# Add prior#
			if(i<6){#
			pt = A$ctrl[i, 5]#
			if(pt>0){#
			nfn=c("dnorm","dlnorm","dinvgamma")#
			fn=match.fun(nfn[pt])#
			p1=A$ctrl[i, 6]; p2=A$ctrl[i, 7]#
			curve(unlist(lapply(x,fn,p1,p2)),#
				xl[1],xl[2],add=T, col=colr(4, 0.7), lwd=2, lty=3)#
			}}#
		}#
	}#
	sapply(1:9, plot.den)#
}#
par(mfcol=c(5, 6), mar=c(2, 2, 1, 1))#
plot(A$post.samp)#
plot(A$mc)
colr
setwd('/Users/stevenmartell1/Documents/ADMB/ADMB Course/ADMB Australia/MeyerMillar')
R-script for the state-space production model with random effects.#
# Author: Steven Martell#
# Date: May 21,  2012#
# Location: Hobart,  Tasmania#
# Libraries#
source("read.admb.R")#
A <- read.admb("pm")#
class(A) <- "admb"#
class(A$post.samp) <- "psv"#
A$mc <- read.table("pm.mcmc", header=TRUE)#
class(A$mc) <- "mc"#
A$ctrl<- read.table("pm.ctl", header=FALSE)#
#
colr <- #
function(col.pal=1,a=1)#
{#
    col.rgb<-col2rgb(col.pal)/255#
    rgb(t(col.rgb),alpha=a)#
}#
#
print.admb<- function(A)#
{#
	print(A$fit$npar)#
}#
#
plot.admb <- function(A, add=FALSE, ...)#
{#
	with(A, {#
		yr = iyr#
		par(mfcol=c(2, 2), mar=c(5, 4, 1, 1))#
		plot(yr, bt, type="l", xlab="Year", ylab="Biomass", ylim=c(0, max(bt)))#
		plot(yr, pt, type="l", xlab="Year", ylab="Depletion", ylim=c(0, 1))#
		plot(yr, it_hat, type="l", xlab="Year", ylab="CPUE")#
		points(yr, it, pch=20)#
		plot(yr, epsilon, type="h", xlab="Year", ylab="Residual")			#
	})#
}#
#
plot.psv <- function(ps)#
{#
	# ps is a matrix of posterior sample values#
	require(hacks)#
	quantiles <- apply(ps,2,quantile, probs=c(0.025, 0.5, 0.975))#
	lbl=A$fit$names#
	ii <<- 0#
	plot.trace <- function(x)#
	{#
		ii <<- ii +1#
		qi = quantile(x, probs=c(0.025,0.25,  0.5, 0.75, 0.975))#
		plot(x, type="l", xlab="Iteration", ylab="Posterior sample", main=lbl[ii])#
		xx = c(1, length(x), length(x), 1)#
		yy = c(qi[1], qi[1], qi[5], qi[5])#
		polygon(xx, yy, col=colr("grey", 0.2), border=NA)#
		yy = c(qi[2], qi[2], qi[4], qi[4])#
		polygon(xx, yy, col=colr("grey", 0.3), border=NA)#
		abline(h=qi[3], col=colr(2, 0.5), lwd=3)#
	}#
	apply(ps, 2, plot.trace)#
}#
plot.mc <- function(mc)#
{#
	require(MCMCpack)	# needed for dinvgamma#
	par(mfrow=c(3, 3), mar=c(5, 4, 1, 1))#
	pr.fn <- #
	plot.den <- function(i)#
	{#
		lbl <- names(mc)#
		ps  <- mc[[i]]#
		if(sd(ps)!=0)#
		{#
			psd = density(ps, adjust=1.5)#
			xl  = range(ps)*c(0.0, 1.5)#
			plot(psd, ylab="posterior density", xlab=lbl[i], main="", xlim=xl, lwd=2)#
			# Add prior#
			if(i<6){#
			pt = A$ctrl[i, 5]#
			if(pt>0){#
			nfn=c("dnorm","dlnorm","dinvgamma")#
			fn=match.fun(nfn[pt])#
			p1=A$ctrl[i, 6]; p2=A$ctrl[i, 7]#
			curve(unlist(lapply(x,fn,p1,p2)),#
				xl[1],xl[2],add=T, col=colr(4, 0.7), lwd=2, lty=3)#
			}}#
		}#
	}#
	sapply(1:9, plot.den)#
}#
par(mfcol=c(5, 6), mar=c(2, 2, 1, 1))#
plot(A$post.samp)#
plot(A$mc)
p1()
p1
p2
vonBH.R#
#
# DATA SECTION#
require(Riscam)#
require(ggplot2)#
A <- read.admb("vonBH")#
A$rp <- read.table("vonBH.mcmc", header=TRUE)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF          <- data.frame(area=sa[A$area],#
				sex=sx[A$sex], age=A$age, #
				fl=A$fl, fl_hat=A$fl_hat, #
				epsilon=A$epsilon)#
#
# GRAPHICAL SECTION#
# Index:#
# 		p1 <- length-at-age plots for male and female by area#
# 		p2 <- length-age by sex overlayed areas#
#       p3 <- residual distribution as box plots by sex#
#       p4 <- qqplot on residuals by area and sex#
# 		p5 <- qqplot on age residuals #
#		p6 <- weight-at-age fits by area and sex#
#       p7 <- Marginal posteriors for F0.1 for male and female by area panels#
#       p8 <- Marginal posterior plots for F0.1 for female by area.#
#
quartz("Size at age", width=10, height=6)#
#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.15)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p
pairs(A$post.samp[,1:11])
A$fit$names
dim(A$post.samp)
length(A$fit$names)
A$fit$n
names(A$fit)
A$fit$nopar
colnames(A$post.samp)<-A$fit$names[1:A$fit$nopar]
head(A$post.samp)
A$post.samp             <- as.data.frame(A$post.samp)
is.data.frame(A$post.samp)
require(reshape2)
mdf = melt(A$post.samp)
head(mdf)
p<-ggplot(subset(mdf,variable=="m"))+geom_line()
p
qplot(m,data=mdf)
qplot(m,data=mdf)+geom_line()
qplot(m,data=mdf,geom="line")
qplot(m,data=A$post.samp,geom="line")
A$post.samp$m
qplot(A$post.samp$m)
qplot(A$post.samp$m,geom="line")
vonBH.R#
#
# DATA SECTION#
require(Riscam)#
require(ggplot2)#
A 						<- read.admb("vonBH")#
A$rp 					<- read.table("vonBH.mcmc", header=TRUE)#
colnames(A$post.samp)	<- A$fit$names[1:A$fit$nopar]#
A$post.samp             <- as.data.frame(A$post.samp)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF          <- data.frame(#
				area=sa[A$area],#
				sex=sx[A$sex], #
				age=A$age, #
				fl=A$fl, #
				fl_hat=A$fl_hat, #
				epsilon=A$epsilon)#
# GRAPHICAL SECTION#
# Index:#
# 		p1 <- length-at-age plots for male and female by area#
# 		p2 <- length-age by sex overlayed areas#
#       p3 <- residual distribution as box plots by sex#
#       p4 <- qqplot on residuals by area and sex#
# 		p5 <- qqplot on age residuals #
#		p6 <- weight-at-age fits by area and sex#
#       p7 <- Marginal posteriors for F0.1 for male and female by area panels#
#       p8 <- Marginal posterior plots for F0.1 for female by area.#
#
quartz("Size at age", width=10, height=6)#
#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.15)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p
vonBH.R#
#
# DATA SECTION#
require(Riscam)#
require(ggplot2)#
A 						<- read.admb("vonBH")#
A$rp 					<- read.table("vonBH.mcmc", header=TRUE)#
colnames(A$post.samp)	<- A$fit$names[1:A$fit$nopar]#
A$post.samp             <- as.data.frame(A$post.samp)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF          <- data.frame(#
				area=sa[A$area],#
				sex=sx[A$sex], #
				age=A$age, #
				fl=A$fl, #
				fl_hat=A$fl_hat, #
				epsilon=A$epsilon)#
# GRAPHICAL SECTION#
# Index:#
# 		p1 <- length-at-age plots for male and female by area#
# 		p2 <- length-age by sex overlayed areas#
#       p3 <- residual distribution as box plots by sex#
#       p4 <- qqplot on residuals by area and sex#
# 		p5 <- qqplot on age residuals #
#		p6 <- weight-at-age fits by area and sex#
#       p7 <- Marginal posteriors for F0.1 for male and female by area panels#
#       p8 <- Marginal posterior plots for F0.1 for female by area.#
#
quartz("Size at age", width=10, height=6)#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p0 <- p#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.15)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p
p0
geom_point
?geom_point
?ggplot
autoplot(A$post.samp)
vonBH.R#
#
# DATA SECTION#
require(Riscam)#
require(ggplot2)#
A 						<- read.admb("vonBH")#
A$rp 					<- read.table("vonBH.mcmc", header=TRUE)#
colnames(A$post.samp)	<- A$fit$names[1:A$fit$nopar]#
A$post.samp             <- as.data.frame(A$post.samp)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF          <- data.frame(#
				area=sa[A$area],#
				sex=sx[A$sex], #
				age=A$age, #
				fl=A$fl, #
				fl_hat=A$fl_hat, #
				epsilon=A$epsilon)#
# GRAPHICAL SECTION#
# Index:#
# 		p1 <- length-at-age plots for male and female by area#
# 		p2 <- length-age by sex overlayed areas#
#       p3 <- residual distribution as box plots by sex#
#       p4 <- qqplot on residuals by area and sex#
# 		p5 <- qqplot on age residuals #
#		p6 <- weight-at-age fits by area and sex#
#       p7 <- Marginal posteriors for F0.1 for male and female by area panels#
#       p8 <- Marginal posterior plots for F0.1 for female by area.#
#
quartz("Size at age", width=10, height=6)#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
ggsave(p1, file="../../FIGS/lengthAgeFit.pdf")#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.15)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p
vonBH.R#
#
# DATA SECTION#
require(Riscam)#
require(ggplot2)#
A 						<- read.admb("vonBH")#
A$rp 					<- read.table("vonBH.mcmc", header=TRUE)#
colnames(A$post.samp)	<- A$fit$names[1:A$fit$nopar]#
A$post.samp             <- as.data.frame(A$post.samp)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF          <- data.frame(#
				area=sa[A$area],#
				sex=sx[A$sex], #
				age=A$age, #
				fl=A$fl, #
				fl_hat=A$fl_hat, #
				epsilon=A$epsilon)#
# GRAPHICAL SECTION#
# Index:#
# 		p1 <- length-at-age plots for male and female by area#
# 		p2 <- length-age by sex overlayed areas#
#       p3 <- residual distribution as box plots by sex#
#       p4 <- qqplot on residuals by area and sex#
# 		p5 <- qqplot on age residuals #
#		p6 <- weight-at-age fits by area and sex#
#       p7 <- Marginal posteriors for F0.1 for male and female by area panels#
#       p8 <- Marginal posterior plots for F0.1 for female by area.#
#
quartz("Size at age", width=10, height=6)#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
ggsave(p1, file="../../FIGS/fig:lengthAgeFit.pdf")#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.15)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p
vonBH.R#
#
# DATA SECTION#
require(Riscam)#
require(ggplot2)#
A 						<- read.admb("vonBH")#
A$rp 					<- read.table("vonBH.mcmc", header=TRUE)#
colnames(A$post.samp)	<- A$fit$names[1:A$fit$nopar]#
A$post.samp             <- as.data.frame(A$post.samp)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF          <- data.frame(#
				area=sa[A$area],#
				sex=sx[A$sex], #
				age=A$age, #
				fl=A$fl, #
				fl_hat=A$fl_hat, #
				epsilon=A$epsilon)#
# GRAPHICAL SECTION#
# Index:#
# 		p1 <- length-at-age plots for male and female by area#
# 		p2 <- length-age by sex overlayed areas#
#       p3 <- residual distribution as box plots by sex#
#       p4 <- qqplot on residuals by area and sex#
# 		p5 <- qqplot on age residuals #
#		p6 <- weight-at-age fits by area and sex#
#       p7 <- Marginal posteriors for F0.1 for male and female by area panels#
#       p8 <- Marginal posterior plots for F0.1 for female by area.#
#
quartz("Size at age", width=10, height=6)#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
ggsave(p1, file="../../FIGS/fig:lengthAgeFit.pdf")#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0, alpha=0.15)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.15)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p
setwd('/Users/stevenmartell1/Documents/IPHC/SizeLimitz/src/VONB')
vonBH.R#
#
# DATA SECTION#
require(Riscam)#
require(ggplot2)#
A 						<- read.admb("vonBH")#
A$rp 					<- read.table("vonBH.mcmc", header=TRUE)#
colnames(A$post.samp)	<- A$fit$names[1:A$fit$nopar]#
A$post.samp             <- as.data.frame(A$post.samp)#
#
sx          <- c("Female","Male")#
sa          <- c("2A","2B","2C","3A","3B","4A","4B","4C","4D")#
A$rp$area   <- sa[A$rp$area]#
A$rp$sex    <- sx[A$rp$sex]#
DF          <- data.frame(#
				area=sa[A$area],#
				sex=sx[A$sex], #
				age=A$age, #
				fl=A$fl, #
				fl_hat=A$fl_hat, #
				epsilon=A$epsilon)#
# GRAPHICAL SECTION#
# Index:#
# 		p1 <- length-at-age plots for male and female by area#
# 		p2 <- length-age by sex overlayed areas#
#       p3 <- residual distribution as box plots by sex#
#       p4 <- qqplot on residuals by area and sex#
# 		p5 <- qqplot on age residuals #
#		p6 <- weight-at-age fits by area and sex#
#       p7 <- Marginal posteriors for F0.1 for male and female by area panels#
#       p8 <- Marginal posterior plots for F0.1 for female by area.#
#
quartz("Size at age", width=10, height=6)#
p  <- ggplot(DF, aes(age, fl, col=factor(sex))) + geom_point(size=1, alpha=0.3) #
p  <- p + geom_line(aes(age, fl_hat, col=factor(sex)), size=1) #
p  <- p + facet_wrap(~area)#
p  <- p + labs(col="Sex") + xlab("Age (years)") + ylab("Fork length (cm)")#
p1 <- p#
ggsave(p1, file="../../FIGS/fig:lengthAgeFit.pdf")#
#
p  <- ggplot(DF, aes(age, fl, col=area)) +geom_point(size=1)#
p  <- p + geom_line(aes(age, fl_hat, col=area), size=1) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Fork length (cm)")#
p2 <- p#
#
p  <- ggplot(DF, aes(factor(age), epsilon, col=sex))+geom_boxplot(outlier.size = 0.2)#
p  <- p + facet_wrap(~area) + labs(col="Sex")+xlab("Age (years)")+ylab("Residual fork length (cm)")#
p3 <- p#
#
# qq plots#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~area)#
p4 <- p#
p  <- ggplot(DF, aes(sample=epsilon, col=sex)) + stat_qq()#
p  <- p + facet_wrap(~age)#
p5 <- p#
# Allometric relationship.#
# W = a L ^b; a 6.82e-6 b=3.24#
a  <- 6.83e-6#
b  <- 3.24#
p  <- ggplot(DF, aes(age, a*fl^b, col=area)) +geom_point(size=1)#
p  <- p + geom_point(aes(age, a*fl_hat^b, col=area), size=2) + facet_wrap(~sex)#
p  <- p + labs(col="Regulatory\nArea") + xlab("Age (years)") + ylab("Weight-at-age (lb)")#
p6 <- p#
# Marginal posteriors for F0.1#
p  <- ggplot(A$rp, aes(x=F0.1, fill=sex)) +geom_density(adjust=2, size=0.0, alpha=0.5)#
p  <- p +labs(fill="Sex") + xlim(c(0, 1.0)) + facet_wrap(~area) #
p7 <- p#
p  <- ggplot(subset(A$rp, sex=="Female"), aes(x=F0.1, fill=area)) +geom_density(adjust=1.5, size=0.1, alpha=0.25)#
p  <- p  + facet_wrap(~sex, scales="free") #
p8 <- p
p7
p8
install.packages("maps")#
install.packages("ggplot2")
demo(maps)
?map_data
map_data
require(maps)
require(ggplots)
require(ggplot2)
all_states <- map_data("state")
library(ggplot2)#
library(maps)#
#load us map data#
all_states <- map_data("state")#
#plot all states with ggplot#
p <- ggplot()#
p <- p + geom_polygon( data=all_states, aes(x=long, y=lat, group = group),colour="white", fill="grey10" )#
p
states
p <- ggplot()#
p <- p + geom_polygon( data=states, aes(x=long, y=lat, group = group),colour="white", fill="grey10" )#
p
